# 迭代器模式

Iterator 迭代器模式是用来为容纳多个物件的容器提供依序操作各个元素的方法。

## 外部迭代器

[array_iterator.rb](src/array_iterator.rb)

## 内部迭代器

对于不支持闭包的语言来说，使用内部迭代器的意义不大。举个简单例子，现在需要将 array 中的元素转存到 rtn 中。使用内部迭代器该如是写：

```ruby
rtn = []
array.each { |ele| rtn.push(ele) }
```

如果该语言不支持闭包，这样写是有语法错误的。因为在 {} 中根本就无法访问到 rtn 。另外一个例子，现在需要将 array 中的元素全部输出。

```ruby
array.each { |ele| puts ele }
```

即使该语言不支持闭包，这样写也没问题，但是这样写的意义不大。因为在这个区块中你无法使用上文定义的局部变量，只能使用全局的变量和方法，这样会显得很笨拙。

## 总结

- 外部迭代器的缺点，迭代器和集合之间有着紧密的联系。为了能够依序取出物件，迭代器需要操作集合的内部结构。这种方法实际上破坏了集合内部的封装动作。
- 内部迭代器的缺点，不能同时平行反复处理。如果需要将两个 hash 中的元素取出来构成一个二维数组，使用内部迭代器是无法同时平行做的。不支持闭包的语言使用内部迭代器没什么意义。
